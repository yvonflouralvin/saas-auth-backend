trigger:
- main

variables:
  REGISTRY: saasdrc.azurecr.io
  IMAGE_NAME: auth-backend
  TAG: 1.0.1

pool:
  name: eShopOnWebSelfPool

steps:
- checkout: self

# ðŸ”¹ Build Docker Image
- script: |
    docker build \
      -t $(REGISTRY)/saas-workspace/$(IMAGE_NAME):$(TAG) \
      -t $(REGISTRY)/saas-workspace/$(IMAGE_NAME):latest \
      .
  displayName: 'Docker Build'

# ðŸ”¹ Push Docker Image
- script: |
    docker push $(REGISTRY)/saas-workspace/$(IMAGE_NAME):$(TAG)
    docker push $(REGISTRY)/saas-workspace/$(IMAGE_NAME):latest
  displayName: 'Docker Push'